<div [class.invisible]="!isBuildingVisible || isLoading" class="text-muted my-1 saving text-center  small w-100">
    <i class="fas fa-save mr-1" aria-hidden="true"></i>
    <span *ngIf="isSaving">Saving...</span>
    <span *ngIf="!isSaving">All changes saved</span>
</div>

<div class="row h-95">

    <div class="col-12 position-relative h-100">

        <div class=" position-relative d-flex justify-content-start h-99 rounded-right"
            [class.overflow-hidden]="team?.isExample && isBuildingVisible" [class.box-shadow]="true">

            <div [class.invisible]="!isBuildingVisible" [class.d-flex]="true"
                class="h-100 collapsible  bg-accent open-nav flex-column justify-content-start align-items-center cursor-pointer collapsible "
                [class.col-0]="!isBuildingPanelCollapsed" [class.col-auto]="isBuildingPanelCollapsed"
                 (click)="isBuildingPanelCollapsed=false">
                <span class="h2" *ngIf="isBuildingPanelCollapsed">
                    <i class="fa fa-angle-right text-white" aria-hidden="true"></i>

                </span>
            </div>
            <div [class.d-none]="!isBuildingVisible" [class.col-0]="isBuildingPanelCollapsed"
                [class.col-6]="!isBuildingPanelCollapsed" [class.col-xl-5]="!isBuildingPanelCollapsed"
                [class.px-0]="!isBuildingPanelCollapsed" class="collapsible sidenav h-100 justify-content-start">
                <div id="sidenav-hierarchy" class="hierarchy w-100 h-100 card border-light bg-white rounded"
                    [class.d-none]="isBuildingPanelCollapsed" [class.d-block]="!isBuildingPanelCollapsed">
                    <div class="card border-0 bg-transparent">
                        <button class="position-absolute top-right btn bg-transparent"
                            [class.invisible]="isBuildingPanelCollapsed" (click)="isBuildingPanelCollapsed=true">
                            <span aria-hidden="true" class="text-muted">
                                <i class="fas fa-times"></i>
                            </span>
                        </button>
                        <div class="card-body" [class.show]="!isBuildingPanelCollapsed"
                            [class.hide]="isBuildingPanelCollapsed">
                            <building #building [user]="user" [isEmptyMap]="isEmptyMap" (save)="saveChanges($event)"
                                (openDetails)="onOpenDetailsToEdit($event)"></building>

                        </div>
                    </div>

                </div>
            </div>
            <div [class.d-none]="!isBuildingVisible" [class.col-0]="isDetailsPanelCollapsed"
                [class.col-6]="!isDetailsPanelCollapsed" [class.px-0]="!isDetailsPanelCollapsed"
                [class.col-xl-5]="!isDetailsPanelCollapsed"
                class="collapsible bg-white border details h-100 justify-content-start rounded-right overflow-y">
                <div id="sidenav-details" class="h-100 w-100 rounded-right" [class.d-none]="isDetailsPanelCollapsed"
                    [class.d-block]="!isDetailsPanelCollapsed">
                    <div class="card border-0 bg-transparent">
                        <button class="position-absolute top-right btn bg-transparent"
                            [class.invisible]="isDetailsPanelCollapsed" (click)="isDetailsPanelCollapsed=true">
                            <span aria-hidden="true" class="text-muted">
                                <i class="fas fa-times"></i>
                            </span>
                        </button>
                        <!-- <button class="position-absolute top-left btn btn-link ml-2" (click)="toggleEditMode()">
                            {{isEditMode ? "View" : "Edit"}}
                        </button> -->

                        <div class="card-body" [class.show]="!isDetailsPanelCollapsed"
                            [class.hide]="isDetailsPanelCollapsed">

                            <initiative *ngIf="!isDetailsPanelCollapsed" #initiative [dataset]="dataset"
                                [node]="openedNode" [team]="team" (edited)="saveDetailChanges()"
                                [isEditMode]="isEditMode" (editTags)="onEditTags()"></initiative>
                        </div>
                    </div>
                </div>


            </div>


            <div class="h-100 flex-shrink" id="main" [ngStyle]="{'width':'calc(100% - ' + (true ? 0 : 8) + 'px)'}">
                <div class="h-100 ">
                    <ng-container *ngIf="isLoading">
                        <div class="d-flex justify-content-center align-items-center h-100 ">
                            <div class="pulse">
                                <h1>
                                    <span class="text-accent ">Great news!</span> Your circles are here.
                                </h1>
                                <h4 class="text-muted ">We just need a sec to stick them back together </h4>
                            </div>

                        </div>
                    </ng-container>
                    <ng-container *ngIf="!isLoading">
                        <!-- <div class="bg-danger h-100"></div>  -->
                        <mapping [tags]="selectableTags" [isEmptyMap]="isEmptyMap"
                            (viewDetails)="onOpenDetailsToView($event)" (editDetails)="onOpenDetailsToEdit($event)"
                            (addInitiative)="addInitiative($event)" (removeInitiative)="removeInitiative($event)"
                            (openTreePanel)="isBuildingPanelCollapsed=false"
                            (expandTree)="buildingComponent.toggleAll(true)"
                            (toggleEditingPanelsVisibility)="toggleEditingPanelsVisibility($event)">
                        </mapping>
                    </ng-container>
                </div>
            </div>

        </div>
    </div>
</div>