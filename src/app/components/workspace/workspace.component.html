<div class="row header">

    <div id="carouselExampleControls" class="carousel slide col ml-0" data-ride="carousel" data-interval="false">
        <div class="carousel-inner col ml-4" role="listbox">
            <div class="carousel-item">
                <div class="col">
                    <div class="btn-group pull-left d-flex flex-wrap" *ngIf="team">
                        <a *ngFor="let user of members" class="btn btn-link btn-xs no-padding" [class.deleted]="user.isDeleted" routerLink="/map/{{datasetId}}/{{dataset?.initiative?.getSlug()}}/u/{{user.shortid}}/{{user.getSlug()}}">

                            <img *ngIf="!isPictureLoadedMap.get(user?.user_id)" class="blur member rounded-circle" [@fadeInOut]="isFadeInMap.get(user?.user_id)"
                                alt="image" [src]="image" />
                            <img class="member rounded-circle" [@fadeInOut]="isFadeOutMap.get(user?.user_id)" alt="" [src]="user?.picture" (load)="isPictureLoaded(user?.user_id)"
                                placement="bottom" container="body" ngbTooltip="{{user?.name}}" />
                        </a>
                        <a class="btn btn-link btn-xs no-padding" routerLink="/team/{{team?.team_id}}/{{team?.getSlug()}}" placement="bottom" container="body"
                            ngbTooltip="Add team member">
                            <i class="fa fa-plus" aria-hidden="true"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="carousel-item active">
                <div class="col">
                    <div class="pull-left d-flex flex-wrap">
                        <div class="">
                            <ul class="tags">
                                <li *ngFor="let tag of dataset?.tags; let i=index">
                                    <a class="tag small" [class.checked]="tag.isSelected" (click)="tag.isSelected=!tag.isSelected" [style.background]="tag.color">{{tag.name}}</a>
                                </li>
                                <li>
                                    <a routerLink="/map/{{datasetId}}/{{dataset?.initiative?.getSlug()}}/tags" class="small">Edit tags ...</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
            <i class="fa fa-chevron-left black" aria-hidden="true"></i>
            <span class="sr-only">Previous</span>
        </a>
    </div>

    <!--  -->

    <!--  -->


</div>

<div id="sideNavTree" class="" [class.showTree]="!isBuildingPanelCollapsed">
    <a class="btn toggle" (click)="toggleBuildingPanel()" [class.showTree]="!isBuildingPanelCollapsed">
        <i class="fa all" [class.fa-list]="isBuildingPanelCollapsed" aria-hidden="true"></i>
        <i class="fa" [class.fa-times]="!isBuildingPanelCollapsed" aria-hidden="true"></i>
    </a>

    <div id="edit-panel-tree" class="mt-3 ml-1 mr-3 row" [class.showTree]="!isBuildingPanelCollapsed">
        <div class="building">
            <building #building (save)="saveChanges($event)" (openDetails)="openDetails($event)" (openDetailsEditOnly)="openDetails($event,true)">Loading...</building>
        </div>
    </div>
</div>

<div id="sideNavDetails" class="rounded-right" [class.showDetails]="!isDetailsPanelCollapsed" [class.showTree]="!isBuildingPanelCollapsed">
    <a class="btn toggle" (click)="toggleDetailsPanel()" [class.showDetails]="!isDetailsPanelCollapsed">
        <i class="fa" [class.fa-times]="!isDetailsPanelCollapsed" aria-hidden="true"></i>
    </a>

    <div id="edit-panel-details" class=" ml-1 showDetails" [class.showDetails]="!isDetailsPanelCollapsed">
        <div class="details" *ngIf="!isDetailsPanelCollapsed">
            <initiative *ngIf="!isDetailsPanelCollapsed" #initiative [datasetTags]="tags" [datasetId]="datasetId" [node]="openedNode" [parent]="openedNodeParent"
                (edited)="saveDetailChanges()"></initiative>

        </div>
    </div>
</div>

<div id="main" [class.expand]="!isBuildingPanelCollapsed">
    <div class="mapping">
        <mapping (showDetails)="openDetails($event, true)" (addInitiative)="addInitiative($event)" (removeInitiative)="removeInitiative($event)"
            (moveInitiative)="moveInitiative($event)" (closeEditingPanel)="closeEditingPanel()"> Loading...</mapping>
    </div>
</div>


<ng-template #dragConfirmation let-c="close" let-d="dismiss">
    <div class="modal-header">
        You are about to switch teams
        <button type="button" class="close" aria-label="Close" (click)="d(false)">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>

    <div class="modal-body">
        <p>
            Switching teams keeps your initiative structure intact but
            <b>resets authorities and helpers</b> .
        </p>
    </div>
    <div class="modal-footer">
        <p>These changes cannot be undone. Are you sure ? </p>
        <button type="button" class="btn btn-warning" (click)="c(true)">Yes</button>
        <button type="button" class="btn btn-default" (click)="c(false)">No</button>
    </div>
</ng-template>