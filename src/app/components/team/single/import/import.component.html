<div class="w-100">
    <h5 class="card-title">Import team members from a
        <strong>.csv</strong> file.</h5>
    <h6 class="card-subtitle mb-2 text-muted">Once they are imported, they must be invited to view and edit maps.</h6>
</div>


<div class="w-100 h-100 d-flex flex-column justify-content-start">

    <div class="card mb-3 bg-light border-light">
        <div class="card-body">
            <div class="d-flex justify-content-start w-50">
                <div class="custom-file">
                    <input #fileImportInput name="File Upload" id="txtFileUpload" type="file" class="custom-file-input" id="customFile" (change)="fileChangeListener($event)"
                        accept=".csv">
                    <label class="custom-file-label" for="customFile">Choose file</label>
                </div>
                <button class="btn btn-outline-secondary text-muted ml-1" (click)="fileReset()">Reset</button>
            </div>
            <span class="text-info">The file header must be : "First name", "Last name" and "Email" in that order</span>
            <div *ngIf="isFileInvalid" class="text-warning small">Invalid file. Your file header must be : "First name", "Last name" and "Email" in that order</div>

        </div>
    </div>

    <ng-container *ngIf="isParsingFinished">
        <div class="card mb-3 bg-light border-light">
            <div class="card-body">

                <table class="table table-hover tableSection right">
                    <tbody>
                        <ng-container *ngFor="let csvRec of csvRecords;let i=index">
                            <tr class="row pl-2 text-muted">
                                <ng-container *ngFor="let data of csvRec;let j=index">

                                    <td class="wrap" [class.col-3]="j<2" [class.col-5]="j===2" *ngIf="j<3">{{data}}</td>
                                    <td class="col-1" *ngIf="j===3">
                                        <span *ngIf="csvRec[4]===true && csvRec[3] !== 'Imported'" aria-hidden="true" class="text-warning">{{csvRec[3]}}</span>
                                        <i *ngIf="csvRec[4]===true && csvRec[3] === 'Imported'" class="fa fa-check text-success" aria-hidden="true"></i>
                                        <i *ngIf="csvRec[4]===false" class="text-muted fa fa-circle-o-notch fa-spin fa-fw"></i>
                                    </td>
                                </ng-container>

                            </tr>
                        </ng-container>
                    </tbody>
                </table>


            </div>
        </div>
    </ng-container>

    <ng-container *ngIf="isParsingFinished">
        <div class="card mb-3 bg-light border-light ">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <div class="progress w-75" style="height:38px">
                        <div class="progress-bar bg-success" role="progressbar" [style.width.%]="importedSuccessfully" [attr.aria-valuenow]="importedSuccessfully"
                            aria-valuemin="0" [attr.aria-valuemax]="totalRecordsToImport">Imported : {{importedSuccessfully}} </div>
                        <div class="progress-bar bg-warning" role="progressbar" [style.width.%]="importedFailed" [attr.aria-valuenow]="importedFailed"
                            aria-valuemin="0" [attr.aria-valuemax]="totalRecordsToImport">Failed : {{importedFailed}}</div>
                    </div>
                    <div class=" pull-right">
                        <button class="btn btn-outline-success" (click)="importUsers()">Import {{totalRecordsToImport}} users</button>

                    </div>
                </div>
            </div>
        </div>
    </ng-container>

</div>