<ng-template #adminTipContent>
    <span class="text-warning">You don't have permission to add a team.
        <a href="{{KB_URL_PERMISSIONS}}" target="blank">Learn more.</a>
    </span>
</ng-template>

<ng-container *ngIf="isZeroTeam || canCreateUnlimitedTeams()">
    <div class="d-flex flex-column justify-content-center align-items-center" [class.h-75]="isZeroTeam">
        <div class="col-auto">
            <div class="alert alert-danger" role="alert" *ngIf="errorMessage">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                {{errorMessage}}
            </div>
            <h1 class="text-center">Choose a name for your organization</h1>
            <form [formGroup]="createForm" (submit)="createNewTeam()" class="form-group">
                <fieldset *permissionsOnly="Permissions.canCreateTeam; authorisedStrategy: enableFieldset; unauthorisedStrategy: disableFieldset; ">

                    <!-- <small class="form-text text-muted">
                        This is usually your company or organization name
                    </small> -->
                    <div class="input-group form-group">
                        <input type="text" class="form-control rounded mr-1" [class.is-invalid]="createForm.controls['teamName'].invalid  && (createForm.controls['teamName'].dirty || createForm.controls['teamName'].touched)"
                            formControlName="teamName" required>
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-success">Create</button>
                        </span>
                        <div class="input-group-append">
                            <span class="icon-disabled text-muted transparent bg-white border-white input-group-text" [stickyPopover]="adminTipContent"
                                placement='right'></span>
                        </div>
                        <small class="invalid-feedback">
                            Please enter at least 2 characters
                        </small>
                    </div>
                    <div *ngIf="isCreating" class="text-success">
                        <i class="fas fa-circle-notch fa-spin"></i> Setting up your team
                    </div>
                </fieldset>
            </form>

        </div>

    </div>

</ng-container>


<ng-container *ngIf="!isZeroTeam">
    <div class="row d-flex justify-content-between align-items-center my-5">
        <div class="d-flex justify-content-between col">
            <h2 class="text-left "> Organizations
            </h2>
            <a *ngIf="!canCreateUnlimitedTeams()" class="text-muted" href="mailto:support@maptio.com?subject=I need to create more organizations">Need more organizations? Reach out</a>

        </div>

    </div>
    <div class="d-flex flex-column justify-content-center align-items-center row">

        <div class="card-columns col-12">
            <div class="card" *ngFor="let team of teams;trackBy:trackByTeamId">
                <div class="card-body">
                    <h5 class="card-title">
                        <a routerLink="/teams/{{team?.team_id}}/{{team?.getSlug()}}"> {{team?.name}}</a>
                    </h5>
                    <div class="card-text mb-1 d-flex flex-wrap">
                        <div *ngFor="let member of team?.members;trackBy:trackByMemberId" [class.deleted]="member.isDeleted">
                            <img class="rounded-circle member mr-1 mb-1" src="{{member.picture}}" placement="top" container="body"
                                ngbTooltip="{{member.name}}">
                        </div>
                    </div>
                </div>
                <div class="card-footer border-top-0">
                    <small class="text-muted">{{team?.members?.length}} {{team?.members?.length === 1 ? "person" :"people" }}</small>
                </div>
            </div>

        </div>
    </div>

</ng-container>