<ng-template #adminTipContent>
    <span class="text-warning">You don't have permission to add a team.
        <a href="{{KB_URL_PERMISSIONS}}" target="blank">Learn more.</a>
    </span>
</ng-template>

<ng-container *ngIf="isZeroTeam || canCreateUnlimitedTeams()">
    <div class="d-flex flex-column justify-content-center align-items-center" [class.h-75]="isZeroTeam">
        <div class="col-auto">
            <div class="alert alert-danger" role="alert" *ngIf="errorMessage">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                {{errorMessage}}
            </div>
            <h1 class="text-center">Choose a name for your organization</h1>
            <form [class.has-warning]="createForm.controls['teamName'].invalid  && (createForm.controls['teamName'].dirty || createForm.controls['teamName'].touched)"
                [formGroup]="createForm" (submit)="createNewTeam()">
                <fieldset *permissionsOnly="Permissions.canCreateTeam; authorisedStrategy: enableFieldset; unauthorisedStrategy: disableFieldset; ">

                    <small class="form-text text-muted">
                        This is usually your company or organization name
                    </small>
                    <div class="input-group">
                        <input type="text" class="form-control form-control-warning rounded mr-1" formControlName="teamName" placeholder="e.g. Planet Express"
                            required>

                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-success" [class.disabled]="!createForm.valid">Create</button>
                        </span>
                        <div class="input-group-append">
                            <span class="icon-disabled text-muted transparent bg-white border-white input-group-text" [stickyPopover]="adminTipContent"
                                placement='right'></span>
                        </div>
                    </div>
                    <small class="form-control-feedback text-warning" *ngIf="createForm.controls['teamName'].invalid  && (createForm.controls['teamName'].dirty || createForm.controls['teamName'].touched)">
                        This doesnt sound right... actually, is this actually a word?
                    </small>
                </fieldset>
            </form>
            <i *ngIf="isCreating" class="text-muted fa fa-circle-o-notch fa-spin fa-fw ml-3 fa-2x"></i>

        </div>

    </div>

</ng-container>


<ng-container *ngIf="!isZeroTeam">
    <div class="col-12 d-flex justify-content-between align-items-center my-5">
        <div class="d-flex justify-content-between col">
            <h2 class="text-left "> Organizations
            </h2>
            <a *ngIf="!canCreateUnlimitedTeams()" class="text-muted" href="mailto:support@maptio.com?subject=I need to create more organizations">Need more organizations? Reach out</a>

        </div>

    </div>
    <div class="d-flex flex-column justify-content-center align-items-center col-12">

        <div class="card-columns col-12">
            <div class="card" *ngFor="let team of teams;trackBy:trackByTeamId">
                <div class="card-body">
                    <h5 class="card-title">
                        <a routerLink="/teams/{{team?.team_id}}/{{team?.getSlug()}}"> {{team?.name}}</a>
                    </h5>
                    <div class="card-text mb-1 d-flex flex-wrap">
                        <div *ngFor="let member of team?.members;trackBy:trackByMemberId" [class.deleted]="member.isDeleted">
                            <img class="rounded-circle member mr-1 mb-1" src="{{member.picture}}" alt="{{member.name}}" placement="top" container="body"
                                ngbTooltip="{{member.name}}">
                        </div>
                    </div>
                </div>
                <div class="card-footer">
                    <small class="text-muted">{{team?.members?.length}} members</small>
                </div>
            </div>

        </div>
    </div>

</ng-container>