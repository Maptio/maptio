<ng-template #adminTipContent>
    <span class="text-warning">You don't have permission to add a team.
        <a href="{{KB_URL_PERMISSIONS}}" target="blank">Learn more.</a>
    </span>
</ng-template>
<div class="col-4 mt-3 ">

    <h1 class="mt-3">Teams</h1>

    <div class="alert alert-danger" role="alert" *ngIf="errorMessage">
        {{errorMessage}}
    </div>

    <div class="mb-3">
        <form [class.has-warning]="createForm.controls['teamName'].invalid  && (createForm.controls['teamName'].dirty || createForm.controls['teamName'].touched)"
            [formGroup]="createForm" (submit)="createNewTeam()">
            <fieldset *permissionsOnly="Permissions.canCreateTeam; authorisedStrategy: enableFieldset; unauthorisedStrategy: disableFieldset; ">
                <div class="input-group">
                    <input type="text" class="form-control form-control-warning" formControlName="teamName" placeholder="e.g. Planet Express"
                        required>

                    <span class="input-group-btn">
                        <button type="submit" class="btn btn-success" [class.disabled]="!createForm.valid">Create</button>
                    </span>
                    <div class="input-group-append">
                        <span class="icon-disabled text-muted transparent bg-white border-white input-group-text" [stickyPopover]="adminTipContent" placement='right'></span>
                    </div>
                </div>
                <small class="form-text text-muted">
                    This is usually your company or organisation name
                </small>
                <small class="form-control-feedback text-warning" *ngIf="createForm.controls['teamName'].invalid  && (createForm.controls['teamName'].dirty || createForm.controls['teamName'].touched)">
                    This doesnt sound right... actually, is this actually a word?
                </small>
            </fieldset>
        </form>
        <i *ngIf="isCreating" class="text-muted fa fa-circle-o-notch fa-spin fa-fw ml-3 fa-2x"></i>
    </div>

</div>
<div class="col-12 overflow">
    <div class="card-columns ">
        <ngx-loading [show]="isLoading"></ngx-loading>
        <div class="card" *ngFor="let team of teams;trackBy:trackByTeamId">
            <div class="card-body">
                <h5 class="card-title">
                    <a routerLink="/teams/{{team?.team_id}}/{{team?.getSlug()}}"> {{team?.name}}</a>
                </h5>
                <div class="card-text mb-1 d-flex flex-wrap">
                    <div *ngFor="let member of team?.members;trackBy:trackByMemberId" [class.deleted]="member.isDeleted">
                        <img class="rounded-circle member mr-1 mb-1" src="{{member.picture}}" alt="{{member.name}}" placement="top" container="body"
                            ngbTooltip="{{member.name}}">
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <small class="text-muted">{{team?.members?.length}} members</small>
            </div>
        </div>

    </div>
</div>



<!-- <div class="overflow">
    <ngx-loading [show]="isLoading"></ngx-loading>

    <div class="card mb-3 " *ngFor="let team of teams;trackBy:trackByTeamId">

        <div class="d-flex w-100 justify-content-between card-header">
            <h5>
                <a routerLink="/teams/{{team?.team_id}}/{{team?.getSlug()}}"> {{team?.name}}</a>
            </h5>
            <small>{{team?.members?.length}} members</small>
        </div>
        <div class="card-block">
            <div class="mb-1 d-flex flex-wrap">
                <div *ngFor="let member of team?.members;trackBy:trackByMemberId" [class.deleted]="member.isDeleted">
                    <img class="rounded-circle member mr-1 mb-1" src="{{member.picture}}" alt="{{member.name}}" placement="top" container="body"
                        ngbTooltip="{{member.name}}">
                </div>
            </div>
        </div>
    </div>
</div> -->