<form
  class="mt-2 mb-3"
  [formGroup]="memberForm"
  (submit)="save()"
>
  <div class="form-group">
    <label
      class="mb-0 text-uppercase text-bold text-gray-light small"
      for="inputFirstname"
    >
      First name
    </label>

    <input
      type="text"
      id="inputFirstname"
      formControlName="firstname"
      class="form-control form-control-warning"
      [class.is-invalid]="
        (
          memberForm.get('firstname')?.dirty ||
          memberForm.get('firstname')?.touched ||
          isSubmissionAttempted
        ) &&
        !memberForm.get('firstname')?.valid
      "
      placeholder="First name"
      required
      minlength="2"
    />

    <small class="invalid-feedback">2 characters minimum</small>
  </div>

  <div class="form-group">
    <label
      class="mb-0 text-uppercase text-bold text-gray-light small"
      for="inputFirstname"
    >
      Last name
    </label>

    <input
      type="text"
      id="inputLastname"
      formControlName="lastname"
      class="form-control form-control-warning"
      [class.is-invalid]="
        (
          memberForm.get('lastname')?.dirty ||
          memberForm.get('lastname')?.touched ||
          isSubmissionAttempted
        ) &&
        memberForm.get('lastname')?.invalid
      "
      placeholder="Last name"
      minlength="2"
    />

    <small class="invalid-feedback">2 characters minimum</small>
  </div>

  <div class="form-group">
    <label
      class="mb-0 text-uppercase text-bold text-gray-light small"
      for="inputFirstname"
    >
      Profile Image
    </label>

    <maptio-image-upload
      [user]="member"
      (uploadedImageUrl)="onImageUpload($event)"
    ></maptio-image-upload>
  </div>

  <div class="form-group">
    <label
      class="mb-0 text-uppercase text-bold text-gray-light small"
      for="inputEmail"
    >
      Email
    </label>

    <input
      type="text"
      id="inputEmail"
      formControlName="email"
      class="form-control form-control-warning"
      [class.is-invalid]="
        (
          memberForm.get('email')?.dirty ||
          memberForm.get('email')?.touched ||
          isSubmissionAttempted
        ) &&
        memberForm.get('email')?.invalid
      "
      placeholder="Email"
    />

    <small class="invalid-feedback">Please enter a valid email</small>
  </div>

  <span
    *ngIf="isSavingSuccess"
    class="text-green mx-1 flash small"
    [class.show]="isSavingSuccess"
  >
    <i class="fas fa-save"></i>
    Successfully saved!
  </span>

  <span
    *ngIf="savingFailedMessage"
    class="text-danger mx-1 small"
  >
    {{ savingFailedMessage }}
  </span>

  <div class="d-flex justify-content-end mt-2">
    <button
      *ngIf="!memberForm.dirty"
      type="button"
      class="btn btn-outline-secondary mr-2"
      (click)="onCancel()"
    >
      Cancel
    </button>

    <button
      *ngIf="memberForm.dirty"
      type="button"
      class="btn btn-outline-secondary mr-2"
      placement="top"
      container="body"
      mwlConfirmationPopover
      [popoverTitle]="'Warning'"
      [popoverMessage]="'Cancelling will reject any unsaved changes. This cannot be undone. Are you sure?'"
      (confirm)="onCancel()"
      focusbutton="cancel"
      appendToBody="false"
    >
      Cancel
    </button>

    <button
      type="submit"
      class="btn btn-success"
      [disabled]="isSubmissionAttempted && !memberForm.valid"
    >
      Save
    </button>
  </div>

  <span class="text-green" *ngIf="isSaving">
    <i class="fas fa-circle-notch fa-spin mx-1"></i>
    Creating
  </span>
</form>
